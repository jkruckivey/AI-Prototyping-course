<!-- Skip link for keyboard users -->
<a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>

<main id="main-content" role="main">
<div id="dp-wrapper" class="dp-wrapper">
  <div class="dp-progress-placeholder dp-module-progress-icons" style="display: none;">Icon Progress Bar (browser only)</div>

  <!-- Week 3 Wrap-Up -->
  <div class="dp-content-block content-block" data-title="Week 3 — Review & Wrap-Up">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-flag-checkered" aria-hidden="true"></i>&nbsp;Week 3 — Review & Wrap-Up</h2>
    <div class="dp-card card" style="border-left: 4px solid #034638; padding-left: 15px;">
      <div class="card-body">
        <h3 class="card-title dp-ignore-theme">Quick Recap</h3>
        <p>You've mastered <strong>unsupervised learning</strong> fundamentals: clustering for segmentation, PCA for dimensionality reduction, advanced preprocessing techniques, and recommendation systems that drive business value. These techniques help discover hidden patterns without labeled data.</p>
      </div>
    </div>
  </div>

  <!-- Knowledge Check -->
  <div class="dp-content-block content-block" data-title="Knowledge Check">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-clipboard-check" aria-hidden="true"></i>&nbsp;Knowledge Check</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white dp-panel-active-color-dark">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-q1" id="w3-q1-heading">1) When should you use K-means vs hierarchical clustering?</h3>
        <div id="w3-q1" class="dp-panel-content" role="region" aria-labelledby="w3-q1-heading" hidden>
          <p>Use <strong>K-means</strong> for large datasets when you know the number of clusters. Use <strong>hierarchical clustering</strong> for smaller datasets when you want to explore different cluster levels via dendrograms.</p>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-q2" id="w3-q2-heading">2) What does PCA help you achieve?</h3>
        <div id="w3-q2" class="dp-panel-content" role="region" aria-labelledby="w3-q2-heading" hidden>
          <p><strong>Dimensionality reduction</strong> while preserving maximum variance. It creates uncorrelated principal components that capture the most important patterns in your data.</p>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-q3" id="w3-q3-heading">3) How do collaborative filtering and content-based recommendations differ?</h3>
        <div id="w3-q3" class="dp-panel-content" role="region" aria-labelledby="w3-q3-heading" hidden>
          <p><strong>Collaborative filtering</strong> uses patterns from similar users/items ("users like you"). <strong>Content-based</strong> recommends based on item features similar to what users already liked.</p>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-q4" id="w3-q4-heading">4) What is the cold start problem in recommendation systems?</h3>
        <div id="w3-q4" class="dp-panel-content" role="region" aria-labelledby="w3-q4-heading" hidden>
          <p>Difficulty making recommendations for <strong>new users</strong> (no history) or <strong>new items</strong> (no interactions). Solutions include popularity-based defaults, onboarding surveys, or content-based approaches.</p>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-q5" id="w3-q5-heading">5) Why is feature scaling critical for clustering?</h3>
        <div id="w3-q5" class="dp-panel-content" role="region" aria-labelledby="w3-q5-heading" hidden>
          <p>Distance-based algorithms like K-means are <strong>sensitive to scale</strong>. Without scaling, features with larger ranges dominate the distance calculations, leading to biased clusters.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Interactive quiz widget -->
  <div class="dp-content-block content-block" data-title="Interactive Quiz (Optional)">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-play-circle" aria-hidden="true"></i>&nbsp;Interactive Quiz (Optional)</h2>
    <p class="mt-2">Test your understanding with this interactive quiz covering Week 3 concepts.</p>

    <div class="embedded-widget">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

        <style>
            .embedded-widget {
                margin: 20px 0;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                overflow: hidden;
            }

            .embedded-widget .widget-container {
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                font-family: 'Figtree', system-ui, -apple-system, sans-serif;
                line-height: 1.6;
                color: #2c3e50;
                background: #fff;
                min-height: 800px;
            }

            .embedded-widget h2 {
                color: #034638;
                margin: 0 0 1.5rem 0;
                font-size: 1.5rem;
                font-weight: 600;
                text-align: center;
            }

            .embedded-widget .quiz-progress {
                background: #f8f9fa;
                border: 1px solid #ddd;
                border-radius: 8px;
                padding: 10px;
                margin-bottom: 20px;
                text-align: center;
            }

            .embedded-widget .progress-bar {
                background: #e9ecef;
                border-radius: 4px;
                height: 8px;
                margin: 10px 0;
                overflow: hidden;
            }

            .embedded-widget .progress-fill {
                background: #034638;
                height: 100%;
                transition: width 0.3s ease;
                width: 0%;
            }

            .embedded-widget .question-number {
                color: #034638;
                font-weight: bold;
                font-size: 0.9em;
                margin-bottom: 10px;
            }

            .embedded-widget .question-container h3 {
                color: #2c3e50;
                margin-bottom: 1rem;
                font-size: 1.1rem;
                line-height: 1.4;
            }

            .embedded-widget .answer-options {
                list-style: none;
                padding: 0;
            }

            .embedded-widget .answer-option {
                background: #f8f9fa;
                border: 2px solid #e5e7eb;
                border-radius: 6px;
                margin: 8px 0;
                padding: 12px 15px;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
            }

            .embedded-widget .answer-option:hover {
                border-color: #034638;
                background: #f0f9f4;
            }

            .embedded-widget .answer-option.selected {
                background: rgba(3, 70, 56, 0.1);
                border-color: #034638;
            }

            .embedded-widget .answer-option.correct {
                background: rgba(16, 185, 129, 0.1);
                border-color: #10b981;
            }

            .embedded-widget .answer-option.incorrect {
                background: rgba(239, 68, 68, 0.1);
                border-color: #ef4444;
            }

            .embedded-widget .option-letter {
                background: #034638;
                color: white;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: bold;
                font-size: 0.9em;
                margin-right: 12px;
                flex-shrink: 0;
            }

            .embedded-widget .explanation {
                background: #f0f9f4;
                border-left: 4px solid #034638;
                padding: 15px;
                margin-top: 15px;
                border-radius: 0 6px 6px 0;
                display: none;
            }

            .embedded-widget .explanation.show {
                display: block;
                animation: slideDown 0.3s ease;
            }

            @keyframes slideDown {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }

            .embedded-widget .quiz-actions {
                display: flex;
                justify-content: space-between;
                margin-top: 20px;
                gap: 10px;
            }

            .embedded-widget .btn {
                background: #034638;
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 6px;
                cursor: pointer;
                font-family: 'Figtree', sans-serif;
                font-weight: 500;
                transition: background 0.3s ease;
                flex: 1;
                max-width: 150px;
            }

            .embedded-widget .btn:hover {
                background: #025a44;
            }

            .embedded-widget .btn:disabled {
                background: #cbd5e0;
                cursor: not-allowed;
            }

            .embedded-widget .btn-secondary {
                background: #f8f9fa;
                color: #2c3e50;
                border: 2px solid #e5e7eb;
            }

            .embedded-widget .btn-secondary:hover {
                background: #e9ecef;
            }

            .embedded-widget .quiz-results {
                background: #f0f9f4;
                border: 2px solid #034638;
                border-radius: 8px;
                padding: 20px;
                margin: 20px 0;
                display: none;
            }

            .embedded-widget .quiz-results.show {
                display: block;
                animation: slideDown 0.3s ease;
            }

            .embedded-widget .results-score {
                font-size: 1.5em;
                font-weight: bold;
                color: #034638;
                text-align: center;
                margin-bottom: 15px;
            }

            .embedded-widget .results-message {
                text-align: center;
                margin-bottom: 15px;
                line-height: 1.6;
            }

            .embedded-widget .review-list {
                list-style: none;
                padding: 0;
                margin-top: 15px;
            }

            .embedded-widget .review-item {
                padding: 8px;
                margin: 5px 0;
                border-left: 3px solid transparent;
            }

            .embedded-widget .review-item.correct {
                border-left-color: #10b981;
            }

            .embedded-widget .review-item.incorrect {
                border-left-color: #ef4444;
            }

            @media (max-width: 450px) {
                .embedded-widget .btn {
                    padding: 10px 16px;
                    font-size: 0.9em;
                }

                .embedded-widget .answer-option {
                    padding: 10px 12px;
                }

                .embedded-widget .quiz-actions {
                    flex-direction: column;
                }

                .embedded-widget .btn {
                    max-width: none;
                }
            }
        </style>

        <div class="widget-container">
            <h2>Week 3 Knowledge Check</h2>

            <div class="quiz-progress">
                <div class="question-number" id="questionNumber">Question 1 of 8</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <div id="quizContent">
                <div class="question-container">
                    <h3 id="questionText"></h3>
                    <ul class="answer-options" id="answerOptions"></ul>
                    <div class="explanation" id="explanation"></div>
                </div>
            </div>

            <div class="quiz-results" id="quizResults">
                <div class="results-score" id="resultsScore"></div>
                <div class="results-message" id="resultsMessage"></div>
                <ul class="review-list" id="reviewList"></ul>
            </div>

            <div class="quiz-actions">
                <button class="btn btn-secondary" id="prevBtn" style="display: none;">Previous</button>
                <button class="btn" id="submitBtn">Submit</button>
                <button class="btn" id="nextBtn" style="display: none;">Next</button>
                <button class="btn btn-secondary" id="restartBtn" style="display: none;">Restart Quiz</button>
            </div>
        </div>

        <script>
            const questions = [
                {
                    question: "Which unsupervised learning technique would be BEST for segmenting 500,000 customers into 5 distinct groups?",
                    options: [
                        "Hierarchical clustering with dendrograms",
                        "K-means clustering with k=5",
                        "PCA with 5 principal components",
                        "Association rules mining"
                    ],
                    correct: 1,
                    explanation: "K-means clustering with k=5 is ideal for large datasets when you know the target number of clusters. It's computationally efficient for 500,000 customers. Hierarchical clustering would be too slow for this data size."
                },
                {
                    question: "What is the primary purpose of PCA (Principal Component Analysis)?",
                    options: [
                        "To classify data into predefined categories",
                        "To find frequently occurring patterns in transactions",
                        "To reduce dimensionality while preserving maximum variance",
                        "To predict continuous target variables"
                    ],
                    correct: 2,
                    explanation: "PCA reduces the number of features by creating new uncorrelated variables (principal components) that capture the most important variance in the data. It's not for classification or prediction."
                },
                {
                    question: "You need to handle missing values in a dataset. Which approach is generally MOST appropriate for numerical features?",
                    options: [
                        "Always drop rows with any missing values",
                        "Replace with the mean or median of the feature",
                        "Replace all missing values with zero",
                        "Always use the mode of the feature"
                    ],
                    correct: 1,
                    explanation: "For numerical features, imputing with mean (normal distribution) or median (skewed distribution) preserves the central tendency. Zero imputation can bias the data, and mode is for categorical variables."
                },
                {
                    question: "What is the 'cold start problem' in recommendation systems?",
                    options: [
                        "The system runs slowly when first launched",
                        "Difficulty making recommendations for new users or items with no history",
                        "The algorithm needs warming up before accurate predictions",
                        "Users don't trust initial recommendations"
                    ],
                    correct: 1,
                    explanation: "The cold start problem occurs when there's insufficient data about new users (no interaction history) or new items (no user ratings) to make personalized recommendations."
                },
                {
                    question: "Why is feature scaling critical before applying K-means clustering?",
                    options: [
                        "To make the algorithm run faster",
                        "To ensure all features are positive values",
                        "Because distance calculations are sensitive to feature magnitudes",
                        "To convert categorical variables to numerical"
                    ],
                    correct: 2,
                    explanation: "K-means uses Euclidean distance to assign points to clusters. Without scaling, features with larger ranges (e.g., salary in thousands vs age in tens) will dominate the distance calculations."
                },
                {
                    question: "Which technique would help you find 'Customers who bought X also bought Y' patterns?",
                    options: [
                        "K-means clustering",
                        "Principal Component Analysis",
                        "Hierarchical clustering",
                        "Association rules (market basket analysis)"
                    ],
                    correct: 3,
                    explanation: "Association rules mining (like Apriori algorithm) discovers relationships between items in transactional data, perfect for 'also bought' recommendations. It calculates support, confidence, and lift metrics."
                },
                {
                    question: "When would you choose hierarchical clustering over K-means?",
                    options: [
                        "When you have millions of data points",
                        "When you want to explore different cluster levels with dendrograms",
                        "When clusters are spherical and well-separated",
                        "When you need the fastest possible algorithm"
                    ],
                    correct: 1,
                    explanation: "Hierarchical clustering creates a tree of clusters (dendrogram) allowing you to choose the clustering level post-hoc. It's better for smaller datasets where you want to explore relationships at multiple granularities."
                },
                {
                    question: "What does the 'elbow method' help determine in K-means clustering?",
                    options: [
                        "The optimal number of clusters",
                        "Which features to scale",
                        "The distance metric to use",
                        "How to handle outliers"
                    ],
                    correct: 0,
                    explanation: "The elbow method plots the within-cluster sum of squares (WCSS) against the number of clusters. The 'elbow' point where the rate of decrease sharply levels off suggests the optimal k value."
                }
            ];

            let currentQuestion = 0;
            let userAnswers = [];
            let quizComplete = false;

            function loadQuestion(index) {
                const q = questions[index];
                document.getElementById('questionText').textContent = q.question;
                document.getElementById('questionNumber').textContent = `Question ${index + 1} of ${questions.length}`;

                const optionsHtml = q.options.map((option, i) => `
                    <li class="answer-option" data-index="${i}">
                        <span class="option-letter">${String.fromCharCode(65 + i)}</span>
                        <span>${option}</span>
                    </li>
                `).join('');

                document.getElementById('answerOptions').innerHTML = optionsHtml;

                // Restore selected answer if exists
                if (userAnswers[index] !== undefined) {
                    document.querySelectorAll('.answer-option')[userAnswers[index]].classList.add('selected');
                }

                // Update progress bar
                const progress = ((index + 1) / questions.length) * 100;
                document.getElementById('progressBar').style.width = `${progress}%`;

                // Hide/show explanation
                document.getElementById('explanation').classList.remove('show');
                document.getElementById('explanation').textContent = '';

                // Update button states
                updateButtons();

                // Add click handlers
                document.querySelectorAll('.answer-option').forEach(option => {
                    option.addEventListener('click', selectAnswer);
                });
            }

            function selectAnswer(e) {
                if (quizComplete) return;

                const option = e.currentTarget;
                const index = parseInt(option.dataset.index);

                // Clear previous selection
                document.querySelectorAll('.answer-option').forEach(opt => {
                    opt.classList.remove('selected');
                });

                // Select new answer
                option.classList.add('selected');
                userAnswers[currentQuestion] = index;

                // Enable submit button
                document.getElementById('submitBtn').disabled = false;
            }

            function submitAnswer() {
                const selectedIndex = userAnswers[currentQuestion];
                const q = questions[currentQuestion];

                if (selectedIndex === undefined) return;

                // Show correct/incorrect
                document.querySelectorAll('.answer-option').forEach((option, i) => {
                    if (i === q.correct) {
                        option.classList.add('correct');
                    } else if (i === selectedIndex && i !== q.correct) {
                        option.classList.add('incorrect');
                    }
                    option.style.pointerEvents = 'none';
                });

                // Show explanation
                const explanation = document.getElementById('explanation');
                explanation.textContent = q.explanation;
                explanation.classList.add('show');

                // Update buttons
                document.getElementById('submitBtn').style.display = 'none';

                if (currentQuestion < questions.length - 1) {
                    document.getElementById('nextBtn').style.display = 'block';
                } else {
                    // Last question - show results
                    setTimeout(showResults, 1500);
                }
            }

            function nextQuestion() {
                currentQuestion++;
                loadQuestion(currentQuestion);
                document.getElementById('submitBtn').style.display = 'block';
                document.getElementById('nextBtn').style.display = 'none';
            }

            function prevQuestion() {
                if (currentQuestion > 0) {
                    currentQuestion--;
                    loadQuestion(currentQuestion);
                }
            }

            function showResults() {
                quizComplete = true;
                let correctCount = 0;

                questions.forEach((q, i) => {
                    if (userAnswers[i] === q.correct) {
                        correctCount++;
                    }
                });

                const percentage = Math.round((correctCount / questions.length) * 100);

                // Hide quiz content
                document.getElementById('quizContent').style.display = 'none';
                document.querySelector('.quiz-progress').style.display = 'none';

                // Show results
                const results = document.getElementById('quizResults');
                results.classList.add('show');

                document.getElementById('resultsScore').textContent = `${correctCount} / ${questions.length} (${percentage}%)`;

                let message = '';
                if (percentage === 100) {
                    message = "Perfect score! You've mastered Week 3's unsupervised learning concepts.";
                } else if (percentage >= 75) {
                    message = "Great job! You have a strong understanding of unsupervised learning techniques.";
                } else if (percentage >= 50) {
                    message = "Good effort! Review the topics you missed to strengthen your understanding.";
                } else {
                    message = "Keep studying! Review the material and try again to improve your score.";
                }

                document.getElementById('resultsMessage').textContent = message;

                // Show review list
                const reviewHtml = questions.map((q, i) => {
                    const isCorrect = userAnswers[i] === q.correct;
                    return `
                        <li class="review-item ${isCorrect ? 'correct' : 'incorrect'}">
                            Q${i + 1}: ${isCorrect ? '✓ Correct' : `✗ Incorrect - Correct answer: ${q.options[q.correct]}`}
                        </li>
                    `;
                }).join('');

                document.getElementById('reviewList').innerHTML = reviewHtml;

                // Update buttons
                document.getElementById('prevBtn').style.display = 'none';
                document.getElementById('submitBtn').style.display = 'none';
                document.getElementById('nextBtn').style.display = 'none';
                document.getElementById('restartBtn').style.display = 'block';
            }

            function restartQuiz() {
                currentQuestion = 0;
                userAnswers = [];
                quizComplete = false;

                // Reset UI
                document.getElementById('quizContent').style.display = 'block';
                document.querySelector('.quiz-progress').style.display = 'block';
                document.getElementById('quizResults').classList.remove('show');

                // Reset buttons
                document.getElementById('submitBtn').style.display = 'block';
                document.getElementById('restartBtn').style.display = 'none';

                // Load first question
                loadQuestion(0);
            }

            function updateButtons() {
                const prevBtn = document.getElementById('prevBtn');
                const submitBtn = document.getElementById('submitBtn');

                // Show/hide previous button
                prevBtn.style.display = currentQuestion > 0 ? 'block' : 'none';

                // Disable submit if no answer selected
                submitBtn.disabled = userAnswers[currentQuestion] === undefined;
            }

            // Event listeners
            document.getElementById('submitBtn').addEventListener('click', submitAnswer);
            document.getElementById('nextBtn').addEventListener('click', nextQuestion);
            document.getElementById('prevBtn').addEventListener('click', prevQuestion);
            document.getElementById('restartBtn').addEventListener('click', restartQuiz);

            // Initialize quiz
            loadQuestion(0);
        </script>
    </div>
  </div>

  <!-- Reflection & Next Steps -->
  <div class="dp-content-block content-block" data-title="Reflection & Next Steps">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-pen" aria-hidden="true"></i>&nbsp;Reflection & Next Steps</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-reflect" id="w3-reflect-heading">Reflection</h3>
        <div id="w3-reflect" class="dp-panel-content" role="region" aria-labelledby="w3-reflect-heading" hidden>
          <p>Think about your organization's data: Where could clustering reveal customer segments? What high-dimensional data could benefit from PCA? Which products or content could use better recommendations?</p>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="w3-next" id="w3-next-heading">Next steps</h3>
        <div id="w3-next" class="dp-panel-content" role="region" aria-labelledby="w3-next-heading" hidden>
          <p>Pick one unsupervised technique to pilot: <strong>Customer segmentation</strong> with K-means, <strong>feature reduction</strong> with PCA, or <strong>recommendation engine</strong> with collaborative filtering. Define success metrics before starting.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Business Impact Callout -->
  <div class="dp-callout dp-callout-placeholder card dp-callout-position-default w-100 dp-callout-type-default dp-callout-color-dp-primary">
    <div class="card-body">
      <h3 class="card-title">Business Impact</h3>
      <p class="card-text">Recommendation systems drive significant revenue for digital platforms. Netflix estimates their recommender saves $1B annually by reducing churn through better content discovery. Clustering helps retailers optimize inventory by understanding customer segments.</p>
    </div>
  </div>

  <!-- Helpful Tip / End-of-session reminder -->
  <div class="dp-callout dp-callout-placeholder card dp-callout-position-default w-100 dp-callout-color-dp-primary dp-callout-type-info" role="note" aria-label="Session completion reminder">
    <div class="dp-callout-side-emphasis"><i class="dp-icon fas fa-info-circle dp-default-icon" aria-hidden="true"></i></div>
    <div class="card-body">
      <h4 class="card-title"><strong>Week 3 Complete</strong></h4>
      <p class="card-text">You've mastered unsupervised learning fundamentals: clustering, dimensionality reduction, preprocessing, and recommendations. Ready to apply these techniques to discover hidden patterns in your data.</p>
    </div>
  </div>

  <hr />
  <p>Select <strong>Modules</strong> to return to the course overview, or proceed to Week 4 on Model Evaluation & Business Metrics.</p>
</div>
</main>

<!-- Canvas-safe toggling -->
<script>
(function () {
  function toggleHead(h){
    const content = document.getElementById(h.getAttribute('aria-controls'));
    const expanded = h.getAttribute('aria-expanded') === 'true';
    h.setAttribute('aria-expanded', String(!expanded));
    if (content) content.hidden = expanded;
  }
  document.addEventListener('click', function (e) {
    const h = e.target.closest('.dp-panel-heading[role="button"]');
    if (h) toggleHead(h);
  });
  document.addEventListener('keydown', function (e) {
    if ((e.key === 'Enter' || e.key === ' ') && e.target.matches('.dp-panel-heading[role="button"]')) {
      e.preventDefault(); toggleHead(e.target);
    }
  });
})();
</script>