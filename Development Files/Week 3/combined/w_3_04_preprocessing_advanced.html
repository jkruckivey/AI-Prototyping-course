<!-- Skip link for keyboard users -->
<a href="#main-content" class="sr-only sr-only-focusable">Skip to main content</a>

<main id="main-content" role="main">
<div id="dp-wrapper" class="dp-wrapper">
  <div class="dp-progress-placeholder dp-module-progress-icons" style="display: none;" aria-hidden="true">Icon Progress Bar (browser only)</div>

  <div class="dp-content-block content-block" data-title="Advanced Data Preprocessing">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-filter" aria-hidden="true"></i>&nbsp;Advanced Data Preprocessing</h2>
    <div class="dp-card card" style="border-left: 4px solid #034638; padding-left: 15px;">
      <div class="card-body">
        <h3 class="card-title dp-ignore-theme">What this page covers</h3>
        <p>Master advanced preprocessing: feature selection methods, handling missing data, outlier detection, and encoding strategies that prepare your data for optimal model performance.</p>
      </div>
    </div>
  </div>


  <div class="dp-content-block content-block" data-title="Feature Selection Methods">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-crosshairs" aria-hidden="true"></i>&nbsp;Selecting the Right Features</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white dp-panel-active-color-dark">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="why-select" id="why-select-heading">Why Feature Selection Matters</h3>
        <div id="why-select" class="dp-panel-content" role="region" aria-labelledby="why-select-heading" hidden>
          <p>Not all features are created equal. Strategic feature selection improves model performance and interpretability:</p>
          <div class="row">
            <div class="col-md-6">
              <div class="dp-card card h-100" style="border-left: 4px solid #10b981; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Performance Benefits</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Reduces overfitting</li>
                    <li class="list-group-item">Faster training and prediction</li>
                    <li class="list-group-item">Better generalization</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="dp-card card h-100" style="border-left: 4px solid #3b82f6; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Business Benefits</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Simpler, interpretable models</li>
                    <li class="list-group-item">Lower data collection costs</li>
                    <li class="list-group-item">Easier model maintenance</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="filter-methods" id="filter-methods-heading">Filter Methods: Statistical Significance</h3>
        <div id="filter-methods" class="dp-panel-content" role="region" aria-labelledby="filter-methods-heading" hidden>
          <p>Evaluate features independently using statistical measures before any modeling:</p>
          <div class="table-responsive">
            <table class="ic-Table ic-Table--hover-row" role="table" aria-label="Filter methods for feature selection">
              <caption>Filter Methods for Feature Selection</caption>
              <thead>
                <tr>
                  <th scope="col">Method</th>
                  <th scope="col">Data Type</th>
                  <th scope="col">Measures</th>
                  <th scope="col">Use Case</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Correlation</th>
                  <td>Continuous → Continuous</td>
                  <td>Pearson coefficient</td>
                  <td>Remove redundant features</td>
                </tr>
                <tr>
                  <th scope="row">Chi-square</th>
                  <td>Categorical → Categorical</td>
                  <td>Independence test</td>
                  <td>Feature-target relationships</td>
                </tr>
                <tr>
                  <th scope="row">ANOVA F-test</th>
                  <td>Categorical → Continuous</td>
                  <td>Between-group variance</td>
                  <td>Classification feature selection</td>
                </tr>
                <tr>
                  <th scope="row">Mutual Information</th>
                  <td>Any → Any</td>
                  <td>Information sharing</td>
                  <td>Nonlinear relationships</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="wrapper-methods" id="wrapper-methods-heading">Wrapper Methods: Model-Based Selection</h3>
        <div id="wrapper-methods" class="dp-panel-content" role="region" aria-labelledby="wrapper-methods-heading" hidden>
          <p>Use actual model performance to evaluate feature subsets:</p>
          <ul class="list-group list-group-flush">
            <li class="list-group-item"><strong>Forward Selection</strong>: Start empty, add features that improve performance most</li>
            <li class="list-group-item"><strong>Backward Elimination</strong>: Start with all features, remove least important</li>
            <li class="list-group-item"><strong>Recursive Feature Elimination (RFE)</strong>: Systematically remove features using model weights</li>
            <li class="list-group-item"><strong>Exhaustive Search</strong>: Try all possible combinations (computationally expensive)</li>
          </ul>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="embedded-methods" id="embedded-methods-heading">Embedded Methods: Built-in Selection</h3>
        <div id="embedded-methods" class="dp-panel-content" role="region" aria-labelledby="embedded-methods-heading" hidden>
          <p>Algorithms that perform feature selection automatically during training:</p>
          <div class="row">
            <div class="col-md-6">
              <div class="dp-card card h-100">
                <div class="card-body">
                  <h6 class="card-title">Regularization (L1/L2)</h6>
                  <p>LASSO regression automatically zeros out irrelevant features. Ridge regression reduces their impact.</p>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="dp-card card h-100">
                <div class="card-body">
                  <h6 class="card-title">Tree-based Feature Importance</h6>
                  <p>Random forests and gradient boosting rank features by their contribution to splits.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="dp-content-block content-block" data-title="Handling Missing Data">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-question-circle" aria-hidden="true"></i>&nbsp;Missing Data Strategies</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="missing-types" id="missing-types-heading">Types of Missingness</h3>
        <div id="missing-types" class="dp-panel-content" role="region" aria-labelledby="missing-types-heading" hidden>
          <p>Understanding why data is missing guides your handling strategy:</p>
          <div class="table-responsive">
            <table class="ic-Table ic-Table--hover-row" role="table" aria-label="Types of missing data">
              <caption>Missing Data Types and Characteristics</caption>
              <thead>
                <tr>
                  <th scope="col">Type</th>
                  <th scope="col">Description</th>
                  <th scope="col">Example</th>
                  <th scope="col">Strategy</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">MCAR</th>
                  <td>Missing Completely at Random</td>
                  <td>Survey responses lost due to server error</td>
                  <td>Simple imputation works well</td>
                </tr>
                <tr>
                  <th scope="row">MAR</th>
                  <td>Missing at Random (given other data)</td>
                  <td>Income missing more often for older respondents</td>
                  <td>Use related features for imputation</td>
                </tr>
                <tr>
                  <th scope="row">MNAR</th>
                  <td>Missing Not at Random</td>
                  <td>High earners don't report salary</td>
                  <td>Consider missing as informative signal</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="imputation-methods" id="imputation-methods-heading">Imputation Strategies</h3>
        <div id="imputation-methods" class="dp-panel-content" role="region" aria-labelledby="imputation-methods-heading" hidden>
          <div class="row">
            <div class="col-md-6">
              <div class="dp-card card h-100" style="border-left: 4px solid #f59e0b; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Simple Methods</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>Mean/Median</strong>: For continuous variables</li>
                    <li class="list-group-item"><strong>Mode</strong>: Most frequent category</li>
                    <li class="list-group-item"><strong>Constant</strong>: Domain-specific default</li>
                    <li class="list-group-item"><strong>Forward/Backward fill</strong>: Time series</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="dp-card card h-100" style="border-left: 4px solid #8b5cf6; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Advanced Methods</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item"><strong>KNN Imputation</strong>: Use similar records</li>
                    <li class="list-group-item"><strong>Regression</strong>: Predict missing values</li>
                    <li class="list-group-item"><strong>Multiple Imputation</strong>: Create several datasets</li>
                    <li class="list-group-item"><strong>Matrix Factorization</strong>: Collaborative filtering</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="missing-indicators" id="missing-indicators-heading">Missing Indicator Features</h3>
        <div id="missing-indicators" class="dp-panel-content" role="region" aria-labelledby="missing-indicators-heading" hidden>
          <p>Sometimes the fact that data is missing contains valuable information:</p>
          <div class="dp-card card" style="background-color:#e7f3ff; border:1px solid #b3d9ff;">
            <div class="card-body">
              <h6 class="card-title">Create Binary Indicators</h6>
              <p>Add features like "income_was_missing" = 1 if original income was null, 0 otherwise.</p>
              <p class="mb-0"><strong>When useful</strong>: Missingness patterns correlate with your target variable</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="dp-content-block content-block" data-title="Outlier Detection and Treatment">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-exclamation-circle" aria-hidden="true"></i>&nbsp;Managing Outliers</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="outlier-detection" id="outlier-detection-heading">Detection Methods</h3>
        <div id="outlier-detection" class="dp-panel-content" role="region" aria-labelledby="outlier-detection-heading" hidden>
          <p>Multiple approaches to identify unusual data points:</p>
          <div class="table-responsive">
            <table class="ic-Table ic-Table--hover-row" role="table" aria-label="Outlier detection methods">
              <caption>Outlier Detection Methods and Applications</caption>
              <thead>
                <tr>
                  <th scope="col">Method</th>
                  <th scope="col">How it Works</th>
                  <th scope="col">Best For</th>
                  <th scope="col">Limitation</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Z-Score</th>
                  <td>Standard deviations from mean</td>
                  <td>Normally distributed data</td>
                  <td>Assumes normal distribution</td>
                </tr>
                <tr>
                  <th scope="row">IQR Method</th>
                  <td>Beyond 1.5 × interquartile range</td>
                  <td>Skewed distributions</td>
                  <td>Fixed threshold</td>
                </tr>
                <tr>
                  <th scope="row">Isolation Forest</th>
                  <td>Easy to isolate in random splits</td>
                  <td>High-dimensional data</td>
                  <td>Black box method</td>
                </tr>
                <tr>
                  <th scope="row">Local Outlier Factor</th>
                  <td>Density-based anomaly detection</td>
                  <td>Complex patterns</td>
                  <td>Computationally intensive</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="outlier-treatment" id="outlier-treatment-heading">Treatment Options</h3>
        <div id="outlier-treatment" class="dp-panel-content" role="region" aria-labelledby="outlier-treatment-heading" hidden>
          <p>Once identified, you have several options for handling outliers:</p>
          <div class="row">
            <div class="col-md-4">
              <div class="dp-card card h-100" style="border-left: 4px solid #dc2626; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Remove</h6>
                  <p><strong>When:</strong> Clear data errors</p>
                  <p class="mb-0"><strong>Risk:</strong> Lose valuable information</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="dp-card card h-100" style="border-left: 4px solid #f59e0b; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Cap/Floor</h6>
                  <p><strong>When:</strong> Extreme but valid values</p>
                  <p class="mb-0"><strong>Method:</strong> Set to 95th/5th percentile</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="dp-card card h-100" style="border-left: 4px solid #10b981; padding-left: 12px;">
                <div class="card-body">
                  <h6 class="card-title">Transform</h6>
                  <p><strong>When:</strong> Skewed distributions</p>
                  <p class="mb-0"><strong>Method:</strong> Log, square root, Box-Cox</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="outlier-context" id="outlier-context-heading">Business Context Matters</h3>
        <div id="outlier-context" class="dp-panel-content" role="region" aria-labelledby="outlier-context-heading" hidden>
          <p>Statistical outliers aren't always problematic. Consider business significance:</p>
          <ul class="list-group list-group-flush">
            <li class="list-group-item"><strong>Valuable customers</strong>: High-value transactions might be your most important data</li>
            <li class="list-group-item"><strong>Fraud detection</strong>: Outliers are often the signal you're looking for</li>
            <li class="list-group-item"><strong>Seasonal effects</strong>: Holiday sales spikes are outliers but predictable</li>
            <li class="list-group-item"><strong>Market events</strong>: Stock crashes are outliers but contain valuable information</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="dp-content-block content-block" data-title="Encoding Categorical Variables">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-tags" aria-hidden="true"></i>&nbsp;Categorical Encoding Strategies</h2>
    <div class="dp-panels-wrapper dp-accordion-default dp-panel-hover-color-dp-white">
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="encoding-types" id="encoding-types-heading">Common Encoding Methods</h3>
        <div id="encoding-types" class="dp-panel-content" role="region" aria-labelledby="encoding-types-heading" hidden>
          <div class="table-responsive">
            <table class="ic-Table ic-Table--hover-row" role="table" aria-label="Categorical encoding methods">
              <caption>Categorical Encoding Methods Comparison</caption>
              <thead>
                <tr>
                  <th scope="col">Method</th>
                  <th scope="col">How it Works</th>
                  <th scope="col">Best For</th>
                  <th scope="col">Drawback</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">One-Hot</th>
                  <td>Binary column per category</td>
                  <td>Low cardinality (2-10 categories)</td>
                  <td>Curse of dimensionality</td>
                </tr>
                <tr>
                  <th scope="row">Label Encoding</th>
                  <td>Integer per category</td>
                  <td>Ordinal data with natural order</td>
                  <td>Implies false ordering</td>
                </tr>
                <tr>
                  <th scope="row">Target Encoding</th>
                  <td>Mean of target per category</td>
                  <td>High cardinality categories</td>
                  <td>Risk of overfitting</td>
                </tr>
                <tr>
                  <th scope="row">Frequency Encoding</th>
                  <td>Count of each category</td>
                  <td>Category frequency is informative</td>
                  <td>Loses category identity</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="high-cardinality" id="high-cardinality-heading">High Cardinality Categories</h3>
        <div id="high-cardinality" class="dp-panel-content" role="region" aria-labelledby="high-cardinality-heading" hidden>
          <p>Special techniques for categories with many unique values (e.g., city names, product IDs):</p>
          <div class="row">
            <div class="col-md-6">
              <div class="dp-card card h-100">
                <div class="card-body">
                  <h6 class="card-title">Grouping Strategies</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Keep top N categories, group rest as "Other"</li>
                    <li class="list-group-item">Group by business logic (regions, product lines)</li>
                    <li class="list-group-item">Frequency-based binning</li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="dp-card card h-100">
                <div class="card-body">
                  <h6 class="card-title">Advanced Encoding</h6>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Embedding layers (neural networks)</li>
                    <li class="list-group-item">Hash encoding for massive cardinality</li>
                    <li class="list-group-item">Leave-one-out target encoding</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="dp-panel-group">
        <h3 class="dp-panel-heading" role="button" tabindex="0" aria-expanded="false" aria-controls="encoding-best-practices" id="encoding-best-practices-heading">Best Practices</h3>
        <div id="encoding-best-practices" class="dp-panel-content" role="region" aria-labelledby="encoding-best-practices-heading" hidden>
          <div class="dp-card card" style="border-left: 4px solid #10b981; padding-left: 12px;">
            <div class="card-body">
              <h6 class="card-title">Encoding Guidelines</h6>
              <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Test multiple methods</strong>: Try different encodings and compare performance</li>
                <li class="list-group-item"><strong>Handle unseen categories</strong>: Plan for new categories in production</li>
                <li class="list-group-item"><strong>Consider interactions</strong>: Some combinations of categories matter</li>
                <li class="list-group-item"><strong>Validate on holdout</strong>: Avoid overfitting with target encoding</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="dp-content-block content-block" data-title="Interactive: Preprocessing Pipeline">
    <h2 class="dp-has-icon"><i class="dp-icon fas fa-play-circle" aria-hidden="true"></i>&nbsp;Interactive: Preprocessing Effects</h2>
    <p class="mt-2"><em>Compare:</em> See how different preprocessing choices affect model performance. Test feature selection, outlier handling, and encoding strategies.</p>

    <div class="embedded-widget">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

        <style>
            .embedded-widget {
                margin: 20px 0;
                border: 1px solid #e5e7eb;
                border-radius: 8px;
                overflow: hidden;
            }

            .embedded-widget .dp-wrapper {
                max-width: 900px;
                margin: 0 auto;
                padding: 20px;
                font-family: 'Figtree', system-ui, -apple-system, sans-serif;
                line-height: 1.6;
                color: #2c3e50;
                background: #fff;
            }

            .embedded-widget .dp-content-block {
                margin-bottom: 2rem;
            }

            .embedded-widget .dp-has-icon {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                color: #034638;
                margin: 0 0 1rem 0;
                font-size: 1.5rem;
                font-weight: 600;
            }

            .embedded-widget .dp-card {
                background: white;
                border-radius: 8px;
                padding: 1.5rem;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                margin: 1rem 0;
            }

            .embedded-widget .dp-card.intro-card {
                border-left: 4px solid #034638;
                background: #f8fffe;
            }

            .embedded-widget .pipeline-container {
                display: flex;
                flex-direction: column;
                gap: 0.75rem;
            }

            .embedded-widget .pipeline-step {
                background: white;
                border-radius: 8px;
                padding: 1rem;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                border-left: 4px solid #e5e7eb;
                transition: all 0.3s ease;
            }

            .embedded-widget .pipeline-step.active {
                border-left-color: #034638;
                background: #f0f9f4;
            }

            .embedded-widget .step-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 1rem;
            }

            .embedded-widget .step-title {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                font-weight: 600;
            }

            .embedded-widget .step-number {
                background: #034638;
                color: white;
                width: 24px;
                height: 24px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.8rem;
                font-weight: bold;
            }

            .embedded-widget .step-toggle {
                background: none;
                border: 2px solid #e5e7eb;
                border-radius: 6px;
                padding: 0.5rem 1rem;
                cursor: pointer;
                font-size: 0.9rem;
                transition: all 0.3s ease;
            }

            .embedded-widget .step-toggle.enabled {
                background: #034638;
                color: white;
                border-color: #034638;
            }

            .embedded-widget .step-controls {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 1rem;
                margin-top: 1rem;
            }

            .embedded-widget .control-group {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }

            .embedded-widget .control-group label {
                font-weight: 600;
                font-size: 0.9rem;
            }

            .embedded-widget .control-input {
                display: flex;
                align-items: center;
                gap: 1rem;
            }

            .embedded-widget .control-input input[type="range"] {
                flex: 1;
            }

            .embedded-widget .control-input select {
                flex: 1;
                padding: 0.5rem;
                border: 1px solid #d1d5db;
                border-radius: 4px;
            }

            .embedded-widget .value-display {
                background: #e7f3ff;
                padding: 0.25rem 0.75rem;
                border-radius: 4px;
                font-weight: bold;
                min-width: 50px;
                text-align: center;
                font-size: 0.85rem;
            }

            .embedded-widget .results-container {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
                margin: 1rem 0;
            }

            .embedded-widget .results-section {
                background: white;
                border-radius: 8px;
                padding: 1rem;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }

            .embedded-widget .plot-container {
                height: 200px;
                margin: 0.5rem 0;
                border: 1px solid #e5e7eb;
                border-radius: 6px;
                position: relative;
            }

            .embedded-widget .canvas-plot {
                width: 100%;
                height: 100%;
                border-radius: 4px;
            }

            .embedded-widget .metrics-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
                margin: 1rem 0;
            }

            @media (max-width: 768px) {
                .embedded-widget .metrics-grid {
                    grid-template-columns: 1fr;
                }
            }

            .embedded-widget .metric-card {
                background: #f8f9fa;
                padding: 0.5rem;
                border-radius: 6px;
                text-align: center;
                border: 1px solid #e5e7eb;
            }

            .embedded-widget .metric-value {
                font-size: 1rem;
                font-weight: bold;
                color: #034638;
            }

            .embedded-widget .metric-label {
                font-size: 0.7rem;
                color: #666;
                margin-top: 0.25rem;
            }

            .embedded-widget .run-pipeline-btn {
                background: #034638;
                color: white;
                border: none;
                padding: 1rem 2rem;
                border-radius: 8px;
                cursor: pointer;
                font-size: 1.1rem;
                font-weight: 600;
                width: 100%;
                margin: 1rem 0;
                transition: background 0.3s ease;
            }

            .embedded-widget .run-pipeline-btn:hover {
                background: #022c24;
            }

            .embedded-widget .data-preview {
                background: #f8f9fa;
                border: 1px solid #e5e7eb;
                border-radius: 6px;
                padding: 1rem;
                margin: 1rem 0;
                font-family: monospace;
                font-size: 0.8rem;
                max-height: 150px;
                overflow-y: auto;
            }

            @media (max-width: 768px) {
                .embedded-widget .results-container {
                    grid-template-columns: 1fr;
                }
            }
        </style>

        <div class="dp-wrapper">
            <div class="dp-content-block">
                <h2 class="dp-has-icon">
                    <i class="dp-icon fas fa-cogs" aria-hidden="true"></i>
                    Preprocessing Pipeline Effects
                </h2>
                <div class="dp-card intro-card">
                    <p><strong>Interactive Learning:</strong> Toggle preprocessing steps on/off and see their impact on model performance. Experiment with different data quality scenarios.</p>
                </div>
            </div>

            <div class="pipeline-container">
                <!-- Step 1: Missing Data Handling -->
                <div class="pipeline-step active" id="step-missing">
                    <div class="step-header">
                        <div class="step-title">
                            <div class="step-number">1</div>
                            <h3>Missing Data Handling</h3>
                        </div>
                        <button class="step-toggle enabled" onclick="toggleStep('missing')" id="toggle-missing">Enabled</button>
                    </div>
                    <div class="step-controls">
                        <div class="control-group">
                            <label>Missing Data Strategy</label>
                            <div class="control-input">
                                <select id="missing-strategy" onchange="updatePipeline()">
                                    <option value="mean">Fill with Mean</option>
                                    <option value="median">Fill with Median</option>
                                    <option value="mode">Fill with Mode</option>
                                    <option value="drop">Drop Missing Rows</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>Missing Data Amount (%)</label>
                            <div class="control-input">
                                <input type="range" id="missing-amount" min="0" max="30" value="15" onchange="updateMissingAmount(this.value)">
                                <div class="value-display" id="missing-value">15%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Outlier Detection -->
                <div class="pipeline-step active" id="step-outliers">
                    <div class="step-header">
                        <div class="step-title">
                            <div class="step-number">2</div>
                            <h3>Outlier Detection & Treatment</h3>
                        </div>
                        <button class="step-toggle enabled" onclick="toggleStep('outliers')" id="toggle-outliers">Enabled</button>
                    </div>
                    <div class="step-controls">
                        <div class="control-group">
                            <label>Detection Method</label>
                            <div class="control-input">
                                <select id="outlier-method" onchange="updatePipeline()">
                                    <option value="iqr">IQR Method</option>
                                    <option value="zscore">Z-Score (±3σ)</option>
                                    <option value="isolation">Isolation Forest</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>Treatment Strategy</label>
                            <div class="control-input">
                                <select id="outlier-treatment" onchange="updatePipeline()">
                                    <option value="remove">Remove Outliers</option>
                                    <option value="cap">Cap at Percentiles</option>
                                    <option value="transform">Log Transform</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Feature Scaling -->
                <div class="pipeline-step active" id="step-scaling">
                    <div class="step-header">
                        <div class="step-title">
                            <div class="step-number">3</div>
                            <h3>Feature Scaling</h3>
                        </div>
                        <button class="step-toggle enabled" onclick="toggleStep('scaling')" id="toggle-scaling">Enabled</button>
                    </div>
                    <div class="step-controls">
                        <div class="control-group">
                            <label>Scaling Method</label>
                            <div class="control-input">
                                <select id="scaling-method" onchange="updatePipeline()">
                                    <option value="standard">StandardScaler (Z-score)</option>
                                    <option value="minmax">MinMaxScaler (0-1)</option>
                                    <option value="robust">RobustScaler (Median)</option>
                                    <option value="none">No Scaling</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Feature Selection -->
                <div class="pipeline-step active" id="step-features">
                    <div class="step-header">
                        <div class="step-title">
                            <div class="step-number">4</div>
                            <h3>Feature Selection</h3>
                        </div>
                        <button class="step-toggle enabled" onclick="toggleStep('features')" id="toggle-features">Enabled</button>
                    </div>
                    <div class="step-controls">
                        <div class="control-group">
                            <label>Selection Method</label>
                            <div class="control-input">
                                <select id="feature-method" onchange="updatePipeline()">
                                    <option value="correlation">Remove High Correlation</option>
                                    <option value="variance">Remove Low Variance</option>
                                    <option value="importance">Keep Top K Important</option>
                                    <option value="all">Keep All Features</option>
                                </select>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>Features to Keep</label>
                            <div class="control-input">
                                <input type="range" id="features-count" min="3" max="10" value="7" onchange="updateFeatureCount(this.value)">
                                <div class="value-display" id="features-value">7</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="run-pipeline-btn" onclick="runPipeline()"><i class="fas fa-play" aria-hidden="true"></i> Run Pipeline</button>

            <div class="results-container">
                <div class="results-section">
                    <h3><i class="fas fa-chart-line" aria-hidden="true"></i> Data Quality</h3>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="rows-remaining">-</div>
                            <div class="metric-label">Rows<br>Remaining</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="features-remaining">-</div>
                            <div class="metric-label">Features<br>Remaining</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="missing-remaining">-</div>
                            <div class="metric-label">Missing<br>Values</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="outliers-removed">-</div>
                            <div class="metric-label">Outliers<br>Handled</div>
                        </div>
                    </div>
                    <div class="plot-container">
                        <canvas id="quality-plot" class="canvas-plot"></canvas>
                    </div>
                </div>

                <div class="results-section">
                    <h3><i class="fas fa-bullseye" aria-hidden="true"></i> Performance</h3>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="accuracy-score">-</div>
                            <div class="metric-label">Accuracy<br>Score</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="precision-score">-</div>
                            <div class="metric-label">Precision<br>Score</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="recall-score">-</div>
                            <div class="metric-label">Recall<br>Score</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="f1-score">-</div>
                            <div class="metric-label">F1<br>Score</div>
                        </div>
                    </div>
                    <div class="plot-container">
                        <canvas id="performance-plot" class="canvas-plot"></canvas>
                    </div>
                </div>
            </div>

            <div class="data-preview" id="data-preview">
                <strong>Pipeline Status:</strong> Ready to run preprocessing pipeline...
            </div>
        </div>

        <script>
            let pipelineConfig = {
                missing: { enabled: true, strategy: 'mean', amount: 15 },
                outliers: { enabled: true, method: 'iqr', treatment: 'remove' },
                scaling: { enabled: true, method: 'standard' },
                features: { enabled: true, method: 'correlation', count: 7 }
            };

            let originalData = generateSampleData();
            let processedData = null;
            let performanceHistory = [];

            function generateSampleData() {
                const data = [];
                const features = ['Age', 'Income', 'Tenure', 'Calls', 'Complaints', 'Satisfaction', 'Bills', 'Usage', 'Support', 'Loyalty'];

                for(let i = 0; i < 1000; i++) {
                    const age = 25 + Math.random() * 40;
                    const income = 30000 + age * 1000 + Math.random() * 20000;
                    const tenure = Math.random() * 60;
                    const calls = 5 + Math.random() * 15;
                    const complaints = Math.random() < 0.3 ? Math.floor(Math.random() * 5) : 0;
                    const satisfaction = Math.max(1, Math.min(10, 7 - complaints + Math.random() * 3));
                    const bills = income * 0.05 + Math.random() * 100;
                    const usage = 50 + Math.random() * 200;
                    const support = complaints * 2 + Math.random() * 5;
                    const loyalty = Math.max(0, Math.min(100, satisfaction * 10 + tenure - complaints * 10 + Math.random() * 20));

                    // Introduce some noise and outliers
                    const outlierChance = Math.random();
                    const row = [
                        age + (outlierChance < 0.05 ? Math.random() * 100 : 0),
                        income + (outlierChance < 0.03 ? Math.random() * 100000 : 0),
                        tenure,
                        calls,
                        complaints,
                        satisfaction,
                        bills,
                        usage,
                        support,
                        loyalty
                    ];

                    // Add some missing values
                    row.forEach((val, idx) => {
                        if(Math.random() < pipelineConfig.missing.amount / 100) {
                            row[idx] = null;
                        }
                    });

                    data.push(row);
                }

                return data;
            }

            function toggleStep(stepName) {
                pipelineConfig[stepName].enabled = !pipelineConfig[stepName].enabled;
                const toggle = document.getElementById(`toggle-${stepName}`);
                const step = document.getElementById(`step-${stepName}`);

                if(pipelineConfig[stepName].enabled) {
                    toggle.textContent = 'Enabled';
                    toggle.classList.add('enabled');
                    step.classList.add('active');
                } else {
                    toggle.textContent = 'Disabled';
                    toggle.classList.remove('enabled');
                    step.classList.remove('active');
                }
            }

            function updateMissingAmount(value) {
                pipelineConfig.missing.amount = parseInt(value);
                document.getElementById('missing-value').textContent = value + '%';
                originalData = generateSampleData();
            }

            function updateFeatureCount(value) {
                pipelineConfig.features.count = parseInt(value);
                document.getElementById('features-value').textContent = value;
            }

            function updatePipeline() {
                pipelineConfig.missing.strategy = document.getElementById('missing-strategy').value;
                pipelineConfig.outliers.method = document.getElementById('outlier-method').value;
                pipelineConfig.outliers.treatment = document.getElementById('outlier-treatment').value;
                pipelineConfig.scaling.method = document.getElementById('scaling-method').value;
                pipelineConfig.features.method = document.getElementById('feature-method').value;
            }

            function simulatePreprocessing(data) {
                let result = JSON.parse(JSON.stringify(data)); // Deep copy
                let stats = {
                    originalRows: data.length,
                    originalFeatures: data[0].length,
                    missingHandled: 0,
                    outliersRemoved: 0,
                    finalRows: 0,
                    finalFeatures: 0
                };

                // Step 1: Handle missing data
                if(pipelineConfig.missing.enabled) {
                    const strategy = pipelineConfig.missing.strategy;
                    result = result.filter(row => {
                        const missingCount = row.filter(val => val === null).length;
                        return strategy === 'drop' ? missingCount === 0 : true;
                    });

                    if(strategy !== 'drop') {
                        // Fill missing values (simplified simulation)
                        result.forEach(row => {
                            row.forEach((val, idx) => {
                                if(val === null) {
                                    row[idx] = 50 + Math.random() * 20; // Simulated fill
                                    stats.missingHandled++;
                                }
                            });
                        });
                    }
                }

                // Step 2: Handle outliers
                if(pipelineConfig.outliers.enabled) {
                    const treatment = pipelineConfig.outliers.treatment;
                    if(treatment === 'remove') {
                        const initialLength = result.length;
                        result = result.filter(() => Math.random() > 0.05); // Remove ~5% as outliers
                        stats.outliersRemoved = initialLength - result.length;
                    }
                }

                // Step 3: Feature scaling (doesn't change dimensions)

                // Step 4: Feature selection
                if(pipelineConfig.features.enabled && pipelineConfig.features.method !== 'all') {
                    const keepCount = Math.min(pipelineConfig.features.count, result[0].length);
                    result = result.map(row => row.slice(0, keepCount));
                }

                stats.finalRows = result.length;
                stats.finalFeatures = result[0].length;
                stats.missingRemaining = 0; // After preprocessing

                return { data: result, stats };
            }

            function simulateModelPerformance(processedStats) {
                // Simulate how preprocessing affects model performance
                let accuracy = 0.75; // Base accuracy
                let precision = 0.73;
                let recall = 0.77;

                // Missing data handling impact
                if(pipelineConfig.missing.enabled) {
                    const strategy = pipelineConfig.missing.strategy;
                    const missingAmount = pipelineConfig.missing.amount;
                    if(strategy === 'drop' && missingAmount > 20) {
                        accuracy -= 0.05; // Losing too much data hurts
                    } else {
                        accuracy += 0.03; // Proper handling helps
                    }
                } else {
                    accuracy -= 0.08 * (pipelineConfig.missing.amount / 100); // Missing data hurts
                }

                // Outlier handling impact
                if(pipelineConfig.outliers.enabled) {
                    accuracy += 0.04; // Removing outliers helps
                    precision += 0.03;
                } else {
                    accuracy -= 0.03; // Outliers hurt performance
                }

                // Scaling impact
                if(pipelineConfig.scaling.enabled) {
                    const method = pipelineConfig.scaling.method;
                    if(method !== 'none') {
                        accuracy += 0.02; // Scaling helps most algorithms
                    }
                }

                // Feature selection impact
                if(pipelineConfig.features.enabled) {
                    const method = pipelineConfig.features.method;
                    if(method !== 'all') {
                        accuracy += 0.025; // Removing noise helps
                        precision += 0.02;
                    } else if(processedStats.finalFeatures > 8) {
                        accuracy -= 0.01; // Too many features can hurt
                    }
                }

                // Add some random variation
                accuracy += (Math.random() - 0.5) * 0.02;
                precision += (Math.random() - 0.5) * 0.02;
                recall += (Math.random() - 0.5) * 0.02;

                // Keep values in reasonable range
                accuracy = Math.max(0.5, Math.min(0.95, accuracy));
                precision = Math.max(0.5, Math.min(0.95, precision));
                recall = Math.max(0.5, Math.min(0.95, recall));

                const f1 = 2 * (precision * recall) / (precision + recall);

                return { accuracy, precision, recall, f1 };
            }

            function runPipeline() {
                const result = simulatePreprocessing(originalData);
                processedData = result.data;
                const stats = result.stats;

                // Update data quality metrics
                document.getElementById('rows-remaining').textContent = stats.finalRows.toLocaleString();
                document.getElementById('features-remaining').textContent = stats.finalFeatures;
                document.getElementById('missing-remaining').textContent = stats.missingRemaining;
                document.getElementById('outliers-removed').textContent = stats.outliersRemoved;

                // Simulate model performance
                const performance = simulateModelPerformance(stats);
                performanceHistory.push(performance);

                // Update performance metrics
                document.getElementById('accuracy-score').textContent = (performance.accuracy * 100).toFixed(1) + '%';
                document.getElementById('precision-score').textContent = (performance.precision * 100).toFixed(1) + '%';
                document.getElementById('recall-score').textContent = (performance.recall * 100).toFixed(1) + '%';
                document.getElementById('f1-score').textContent = (performance.f1 * 100).toFixed(1) + '%';

                // Update plots
                plotQualityMetrics(stats);
                plotPerformanceHistory();

                // Update preview
                updateDataPreview(stats);
            }

            function plotQualityMetrics(stats) {
                const canvas = document.getElementById('quality-plot');
                const ctx = canvas.getContext('2d');

                // Set canvas size
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * window.devicePixelRatio || 1;
                canvas.height = rect.height * window.devicePixelRatio || 1;
                ctx.scale(window.devicePixelRatio || 1, window.devicePixelRatio || 1);
                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';

                const width = rect.width;
                const height = rect.height;
                const margin = { top: 30, right: 20, bottom: 50, left: 40 };
                const plotWidth = width - margin.left - margin.right;
                const plotHeight = height - margin.top - margin.bottom;

                // Clear canvas
                ctx.clearRect(0, 0, width, height);

                const data = [
                    { label: 'Original', value: stats.originalRows, color: '#034638' },
                    { label: 'After Missing', value: stats.originalRows - 50, color: '#3b82f6' },
                    { label: 'After Outliers', value: stats.finalRows + stats.outliersRemoved, color: '#f59e0b' },
                    { label: 'Final', value: stats.finalRows, color: '#10b981' }
                ];

                const maxValue = Math.max(...data.map(d => d.value));
                const barWidth = plotWidth / data.length * 0.8;
                const barSpacing = plotWidth / data.length;

                // Draw bars
                data.forEach((item, i) => {
                    const barHeight = (item.value / maxValue) * plotHeight;
                    const x = margin.left + i * barSpacing + (barSpacing - barWidth) / 2;
                    const y = margin.top + plotHeight - barHeight;

                    ctx.fillStyle = item.color;
                    ctx.fillRect(x, y, barWidth, barHeight);

                    // Draw value labels
                    ctx.fillStyle = '#2c3e50';
                    ctx.font = '10px Figtree, sans-serif';
                    ctx.textAlign = 'center';
                    ctx.fillText(item.value.toLocaleString(), x + barWidth/2, y - 5);

                    // Draw x-axis labels
                    ctx.fillText(item.label, x + barWidth/2, height - 10);
                });

                // Draw title
                ctx.font = '12px Figtree, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Data Processing Flow', width / 2, 20);
            }

            function plotPerformanceHistory() {
                if(performanceHistory.length === 0) return;

                const canvas = document.getElementById('performance-plot');
                const ctx = canvas.getContext('2d');

                // Set canvas size
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * window.devicePixelRatio || 1;
                canvas.height = rect.height * window.devicePixelRatio || 1;
                ctx.scale(window.devicePixelRatio || 1, window.devicePixelRatio || 1);
                canvas.style.width = rect.width + 'px';
                canvas.style.height = rect.height + 'px';

                const width = rect.width;
                const height = rect.height;
                const margin = { top: 30, right: 20, bottom: 40, left: 40 };
                const plotWidth = width - margin.left - margin.right;
                const plotHeight = height - margin.top - margin.bottom;

                // Clear canvas
                ctx.clearRect(0, 0, width, height);

                const recent = performanceHistory.slice(-10);
                if(recent.length === 0) return;

                // Scale functions
                const xScale = (i) => margin.left + (i / (recent.length - 1)) * plotWidth;
                const yScale = (val) => margin.top + plotHeight - (val / 100) * plotHeight;

                // Draw axes
                ctx.strokeStyle = '#e5e7eb';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(margin.left, margin.top);
                ctx.lineTo(margin.left, margin.top + plotHeight);
                ctx.lineTo(margin.left + plotWidth, margin.top + plotHeight);
                ctx.stroke();

                // Draw accuracy line
                ctx.strokeStyle = '#034638';
                ctx.lineWidth = 2;
                ctx.beginPath();
                recent.forEach((p, i) => {
                    const x = xScale(i);
                    const y = yScale(p.accuracy * 100);
                    if(i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Draw F1 line
                ctx.strokeStyle = '#e74c3c';
                ctx.beginPath();
                recent.forEach((p, i) => {
                    const x = xScale(i);
                    const y = yScale(p.f1 * 100);
                    if(i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                ctx.stroke();

                // Draw points
                recent.forEach((p, i) => {
                    const x = xScale(i);

                    // Accuracy point
                    ctx.fillStyle = '#034638';
                    ctx.beginPath();
                    ctx.arc(x, yScale(p.accuracy * 100), 3, 0, 2 * Math.PI);
                    ctx.fill();

                    // F1 point
                    ctx.fillStyle = '#e74c3c';
                    ctx.beginPath();
                    ctx.arc(x, yScale(p.f1 * 100), 3, 0, 2 * Math.PI);
                    ctx.fill();
                });

                // Draw title
                ctx.fillStyle = '#2c3e50';
                ctx.font = '12px Figtree, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('Performance Over Runs', width / 2, 20);

                // Draw legend
                ctx.font = '10px Figtree, sans-serif';
                ctx.textAlign = 'left';
                ctx.fillStyle = '#034638';
                ctx.fillRect(margin.left + 10, margin.top + 10, 10, 2);
                ctx.fillText('Accuracy', margin.left + 25, margin.top + 16);
                ctx.fillStyle = '#e74c3c';
                ctx.fillRect(margin.left + 10, margin.top + 25, 10, 2);
                ctx.fillText('F1 Score', margin.left + 25, margin.top + 31);
            }

            function updateDataPreview(stats) {
                const enabledSteps = Object.entries(pipelineConfig)
                    .filter(([key, config]) => config.enabled)
                    .map(([key]) => key)
                    .join(', ');

                const preview = `Pipeline Configuration:
Enabled Steps: ${enabledSteps}
Data Flow: ${stats.originalRows.toLocaleString()} → ${stats.finalRows.toLocaleString()} rows
Features: ${stats.originalFeatures} → ${stats.finalFeatures} features
Data Quality: ${stats.missingHandled} missing values handled, ${stats.outliersRemoved} outliers removed

Impact: ${stats.finalRows < stats.originalRows * 0.7 ? 'Significant data loss' : 'Good data retention'}`;

                document.getElementById('data-preview').innerHTML = preview.replace(/\n/g, '<br>');
            }

            // Initialize plots
            function initializePlots() {
                // Quality plot placeholder
                const qualityCanvas = document.getElementById('quality-plot');
                const qualityCtx = qualityCanvas.getContext('2d');
                const qualityRect = qualityCanvas.getBoundingClientRect();
                qualityCtx.clearRect(0, 0, qualityRect.width, qualityRect.height);
                qualityCtx.fillStyle = '#6b7280';
                qualityCtx.font = '12px Figtree, sans-serif';
                qualityCtx.textAlign = 'center';
                qualityCtx.fillText('Run pipeline to see data flow', qualityRect.width / 2, qualityRect.height / 2);

                // Performance plot placeholder
                const perfCanvas = document.getElementById('performance-plot');
                const perfCtx = perfCanvas.getContext('2d');
                const perfRect = perfCanvas.getBoundingClientRect();
                perfCtx.clearRect(0, 0, perfRect.width, perfRect.height);
                perfCtx.fillStyle = '#6b7280';
                perfCtx.font = '12px Figtree, sans-serif';
                perfCtx.textAlign = 'center';
                perfCtx.fillText('Run pipeline to see performance trends', perfRect.width / 2, perfRect.height / 2);
            }

            // Initialize canvas sizes on window resize
            function resizeCanvases() {
                if (processedData) {
                    plotQualityMetrics({ originalRows: originalData.length, finalRows: processedData.length, missingHandled: 0, outliersRemoved: 0, originalFeatures: 10, finalFeatures: 7 });
                    plotPerformanceHistory();
                } else {
                    initializePlots();
                }
            }

            window.addEventListener('resize', resizeCanvases);
            window.addEventListener('load', initializePlots);
        </script>
    </div>
  </div>

  <div class="dp-callout dp-callout-placeholder card dp-callout-position-default w-100 dp-callout-type-default dp-callout-color-dp-primary">
    <div class="card-body">
      <h3 class="card-title">Pipeline Approach</h3>
      <p class="card-text">Build preprocessing pipelines that can be applied consistently to training and test data. This prevents data leakage and ensures reproducible results.</p>
    </div>
  </div>

  <div class="dp-callout dp-callout-placeholder card dp-callout-position-default w-100 dp-callout-color-dp-primary dp-callout-type-warning">
    <div class="dp-callout-side-emphasis"><i class="dp-icon fas fa-exclamation-triangle dp-default-icon" aria-hidden="true"></i></div>
    <div class="card-body">
      <h4 class="card-title">Data Leakage Risk</h4>
      <p class="card-text">Never use statistics from test data for preprocessing training data. Calculate means, medians, and encodings only from training set, then apply to test set.</p>
    </div>
  </div>

  <hr aria-hidden="true" />
  <p>Select <strong>Next▸</strong> to continue.</p>
</div>
</main>

<script>
(function () {
  function toggleHead(h){
    const content = document.getElementById(h.getAttribute('aria-controls'));
    const expanded = h.getAttribute('aria-expanded') === 'true';
    h.setAttribute('aria-expanded', String(!expanded));
    if (content) content.hidden = expanded;
  }
  document.addEventListener('click', function (e) {
    const h = e.target.closest('.dp-panel-heading[role="button"]');
    if (h) toggleHead(h);
  });
  document.addEventListener('keydown', function (e) {
    if ((e.key === 'Enter' || e.key === ' ') && e.target.matches('.dp-panel-heading[role="button"]')) {
      e.preventDefault(); toggleHead(e.target);
    }
  });
})();
</script>