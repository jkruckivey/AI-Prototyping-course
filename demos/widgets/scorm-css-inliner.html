<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCORM CSS Inliner - Convert Widgets for SCORM Packages</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #034638;
            border-bottom: 3px solid #034638;
            padding-bottom: 10px;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .panel {
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
        }
        .panel h2 {
            margin-top: 0;
            color: #034638;
        }
        textarea {
            width: 100%;
            height: 500px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            border: 1px solid #ccc;
            padding: 10px;
            box-sizing: border-box;
        }
        .controls {
            background: #e8f5e8;
            border: 2px solid #034638;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        button {
            background: #034638;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #045a42;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .stat {
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #034638;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .status.warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
        }
        .status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .instructions {
            background: #e8f5e8;
            border: 2px solid #034638;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .instructions h3 {
            color: #034638;
            margin-bottom: 15px;
        }
        .step {
            margin: 10px 0;
            padding-left: 20px;
            position: relative;
        }
        .step::before {
            content: counter(step-counter);
            counter-increment: step-counter;
            position: absolute;
            left: 0;
            background: #034638;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }
        .instructions ol {
            counter-reset: step-counter;
            list-style: none;
        }
    </style>
</head>
<body>
    <h1>üîß SCORM CSS Inliner</h1>
    <p>Convert widgets that use external CSS files into self-contained SCORM-ready HTML files.</p>

    <div class="instructions">
        <h3>üìã How to Use</h3>
        <ol>
            <li class="step">Copy your widget HTML file content into the "Input" area</li>
            <li class="step">Click "Inline CSS" - this will embed ivey-widget-base.css directly</li>
            <li class="step">Copy the result from "Output" and save as new HTML file</li>
            <li class="step">Use the standalone HTML file in your SCORM package</li>
        </ol>
        <p><strong>Note:</strong> This tool automatically handles the external CSS file reference and Google Fonts.</p>
    </div>

    <div class="controls">
        <button onclick="inlineCSS()">üîÑ Inline CSS for SCORM</button>
        <button onclick="loadSampleWidget()">üìù Load Sample Widget</button>
        <button onclick="copyResult()">üìã Copy Result</button>
        <button onclick="downloadResult()">üíæ Download SCORM-Ready File</button>
        <button onclick="clearAll()">üóëÔ∏è Clear All</button>
    </div>

    <div class="container">
        <div class="panel">
            <h2>Input: Widget HTML with External CSS</h2>
            <textarea id="input" placeholder="Paste your widget HTML here (must contain: link rel='stylesheet' href='ivey-widget-base.css')"></textarea>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="inputSize">0</div>
                    <div class="stat-label">Characters</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="inputLines">0</div>
                    <div class="stat-label">Lines</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <h2>Output: SCORM-Ready HTML</h2>
            <textarea id="output" placeholder="Converted HTML with inlined CSS will appear here..."></textarea>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="outputSize">0</div>
                    <div class="stat-label">Characters</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="cssInlined">0</div>
                    <div class="stat-label">CSS Lines Added</div>
                </div>
            </div>
        </div>
    </div>

    <div id="status"></div>

    <script>
        // The complete ivey-widget-base.css content will be inserted here
        const IVEY_CSS = `/* Ivey Business School - Universal Widget Stylesheet */
/* AI Prototyping Course - Consistent Design System */

/* ========================================
   FONTS & RESET
======================================== */
/* Note: Google Fonts will be inlined separately */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* ========================================
   IVEY COLOR SYSTEM
======================================== */
:root {
    /* Primary Brand Colors */
    --ivey-green: #034638;
    --ivey-purple: #582C83;
    --ivey-orange: #f97316;

    /* Text Colors */
    --text-primary: #1a202c;
    --text-secondary: #4a5568;
    --text-muted: #2d3748;

    /* Background Colors */
    --bg-white: #ffffff;
    --bg-light: #f8fafc;
    --bg-subtle: #f1f5f9;

    /* Border Colors */
    --border-light: #e2e8f0;
    --border-medium: #cbd5e0;

    /* Interactive Colors */
    --hover-bg: #f8fafc;
    --active-shadow: rgba(3, 70, 56, 0.3);
}

/* ========================================
   BASE STYLES
======================================== */
body {
    font-family: 'Figtree', Arial, sans-serif;
    background: var(--bg-white);
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ========================================
   WIDGET POP-OUT BUTTON
======================================== */
.widget-popout-btn {
    position: fixed;
    top: 10px;
    right: 10px;
    background: var(--ivey-green);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 6px;
    z-index: 1000;
    transition: all 0.2s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.widget-popout-btn:hover {
    background: #045a42;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.widget-popout-btn svg {
    width: 14px;
    height: 14px;
}

/* ========================================
   WIDGET CONTAINER
======================================== */
.widget-container {
    max-width: 450px;
    margin: 0 auto;
    background: var(--bg-white);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    overflow: hidden;
    border: 1px solid var(--border-light);
}

.widget-header {
    background: linear-gradient(135deg, var(--ivey-green) 0%, #045a42 100%);
    color: white;
    padding: 20px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.widget-header::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { transform: translateX(-100%); }
    50% { transform: translateX(100%); }
}

.widget-title {
    font-size: 1.2em;
    font-weight: 600;
    margin: 0;
    position: relative;
    z-index: 1;
}

.widget-content {
    padding: 20px;
}

/* ========================================
   FORM ELEMENTS
======================================== */
.form-group {
    margin: 15px 0;
}

.form-label {
    display: block;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 8px;
    font-size: 0.95em;
}

.form-input {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid var(--border-light);
    border-radius: 8px;
    font-size: 16px;
    transition: all 0.2s ease;
    background: var(--bg-white);
}

.form-input:focus {
    outline: none;
    border-color: var(--ivey-green);
    box-shadow: 0 0 0 3px var(--active-shadow);
}

.form-select {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid var(--border-light);
    border-radius: 8px;
    font-size: 16px;
    background: var(--bg-white);
    cursor: pointer;
    transition: all 0.2s ease;
}

.form-select:focus {
    outline: none;
    border-color: var(--ivey-green);
    box-shadow: 0 0 0 3px var(--active-shadow);
}

/* ========================================
   BUTTONS
======================================== */
.btn {
    display: inline-block;
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    text-decoration: none;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    line-height: 1.4;
}

.btn-primary {
    background: var(--ivey-green);
    color: white;
}

.btn-primary:hover {
    background: #045a42;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(3, 70, 56, 0.3);
}

.btn-secondary {
    background: var(--ivey-purple);
    color: white;
}

.btn-secondary:hover {
    background: #6d3499;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(88, 44, 131, 0.3);
}

.btn-outline {
    background: transparent;
    color: var(--ivey-green);
    border: 2px solid var(--ivey-green);
}

.btn-outline:hover {
    background: var(--ivey-green);
    color: white;
}

.btn-small {
    padding: 8px 16px;
    font-size: 14px;
}

.btn-large {
    padding: 16px 32px;
    font-size: 18px;
}

/* ========================================
   CARDS & PANELS
======================================== */
.card {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 20px;
    margin: 15px 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    transition: all 0.2s ease;
}

.card:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.card-header {
    background: var(--bg-subtle);
    margin: -20px -20px 20px -20px;
    padding: 15px 20px;
    border-radius: 12px 12px 0 0;
    font-weight: 600;
    color: var(--text-primary);
}

.card-title {
    font-size: 1.1em;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 10px;
}

.card-text {
    color: var(--text-secondary);
    line-height: 1.6;
}

/* ========================================
   INTERACTIVE ELEMENTS
======================================== */
.option-list {
    list-style: none;
    padding: 0;
    margin: 15px 0;
}

.option-item {
    background: var(--bg-light);
    border: 2px solid var(--border-light);
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 12px;
}

.option-item:hover {
    background: var(--hover-bg);
    border-color: var(--ivey-green);
    transform: translateX(4px);
}

.option-item.selected {
    background: var(--ivey-green);
    color: white;
    border-color: var(--ivey-green);
}

.option-marker {
    width: 24px;
    height: 24px;
    border: 2px solid var(--border-medium);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 14px;
    flex-shrink: 0;
}

.option-item.selected .option-marker {
    background: white;
    color: var(--ivey-green);
    border-color: white;
}

/* ========================================
   CHARTS & VISUALIZATIONS
======================================== */
.chart-container {
    background: var(--bg-white);
    border: 1px solid var(--border-light);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.chart-title {
    font-size: 1.1em;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 15px;
    text-align: center;
}

.chart-wrapper {
    position: relative;
    width: 100%;
    height: 300px;
}

/* ========================================
   PROGRESS & STATUS
======================================== */
.progress-bar {
    background: var(--bg-subtle);
    border-radius: 10px;
    height: 20px;
    overflow: hidden;
    margin: 15px 0;
}

.progress-fill {
    background: linear-gradient(90deg, var(--ivey-green), var(--ivey-purple));
    height: 100%;
    transition: width 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 12px;
    font-weight: 600;
}

.status-indicator {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-success {
    background: #d4edda;
    color: #155724;
}

.status-warning {
    background: #fff3cd;
    color: #856404;
}

.status-danger {
    background: #f8d7da;
    color: #721c24;
}

.status-info {
    background: #d1ecf1;
    color: #0c5460;
}

/* ========================================
   TABLES
======================================== */
.data-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    background: var(--bg-white);
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}

.data-table th,
.data-table td {
    padding: 12px 16px;
    text-align: left;
    border-bottom: 1px solid var(--border-light);
}

.data-table th {
    background: var(--bg-subtle);
    font-weight: 600;
    color: var(--text-primary);
}

.data-table tr:hover {
    background: var(--hover-bg);
}

/* ========================================
   UTILITIES
======================================== */
.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }

.mt-10 { margin-top: 10px; }
.mt-15 { margin-top: 15px; }
.mt-20 { margin-top: 20px; }
.mb-10 { margin-bottom: 10px; }
.mb-15 { margin-bottom: 15px; }
.mb-20 { margin-bottom: 20px; }

.p-10 { padding: 10px; }
.p-15 { padding: 15px; }
.p-20 { padding: 20px; }

.w-100 { width: 100%; }
.h-100 { height: 100%; }

.hidden { display: none; }
.visible { display: block; }

.rounded { border-radius: 8px; }
.rounded-lg { border-radius: 12px; }

.shadow { box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); }
.shadow-lg { box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); }

/* ========================================
   RESPONSIVE DESIGN
======================================== */
@media (max-width: 768px) {
    .widget-container {
        max-width: 100%;
        margin: 0 10px;
        border-radius: 8px;
    }

    .widget-content {
        padding: 15px;
    }

    .btn {
        width: 100%;
        margin: 5px 0;
    }

    .chart-wrapper {
        height: 250px;
    }

    .card {
        padding: 15px;
    }

    .data-table {
        font-size: 14px;
    }

    .data-table th,
    .data-table td {
        padding: 8px 12px;
    }
}

@media (max-width: 480px) {
    .widget-title {
        font-size: 1em;
    }

    .chart-wrapper {
        height: 200px;
    }

    .form-input,
    .form-select {
        font-size: 16px; /* Prevents zoom on iOS */
    }
}

/* ========================================
   ACCESSIBILITY
======================================== */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* ========================================
   FOCUS STATES
======================================== */
*:focus {
    outline: 2px solid var(--ivey-green);
    outline-offset: 2px;
}

.btn:focus,
.form-input:focus,
.form-select:focus {
    outline: none;
    box-shadow: 0 0 0 3px var(--active-shadow);
}

/* ========================================
   HIGH CONTRAST MODE
======================================== */
@media (prefers-contrast: high) {
    :root {
        --border-light: #000000;
        --border-medium: #000000;
        --text-secondary: #000000;
    }

    .card {
        border: 2px solid #000000;
    }

    .btn {
        border: 2px solid #000000;
    }
}`;

        // Google Fonts fallback for SCORM (since @import won't work offline)
        const FONT_FALLBACK = `
        /* Figtree font fallback for SCORM */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }`;

        // Update stats on input
        document.getElementById('input').addEventListener('input', updateInputStats);

        function updateInputStats() {
            const input = document.getElementById('input').value;
            document.getElementById('inputSize').textContent = input.length.toLocaleString();
            document.getElementById('inputLines').textContent = input.split('\\n').length.toLocaleString();
        }

        function updateOutputStats(output, cssLines) {
            document.getElementById('outputSize').textContent = output.length.toLocaleString();
            document.getElementById('cssInlined').textContent = cssLines.toLocaleString();
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = 'status ' + type;
            statusDiv.textContent = message;
        }

        function inlineCSS() {
            const input = document.getElementById('input').value.trim();

            if (!input) {
                showStatus('Please paste your widget HTML first.', 'error');
                return;
            }

            if (!input.includes('ivey-widget-base.css')) {
                showStatus('HTML does not contain reference to ivey-widget-base.css', 'warning');
                return;
            }

            try {
                let output = input;

                // Remove the external CSS link
                output = output.replace(/<link[^>]*href=['"]*ivey-widget-base\\.css['"]*[^>]*>/gi, '');

                // Remove Google Fonts import if present
                output = output.replace(/@import[^;]*fonts\\.googleapis\\.com[^;]*;/gi, '');

                // Find the head section and inject CSS
                const headMatch = output.match(/<head[^>]*>(.*?)<\\/head>/is);
                if (!headMatch) {
                    showStatus('Could not find <head> section in HTML', 'error');
                    return;
                }

                // Insert inlined CSS before closing </head>
                const newHead = headMatch[0].replace(
                    /<\\/head>/i,
                    \`<style>
\${FONT_FALLBACK}
\${IVEY_CSS}
</style>
</head>\`
                );

                output = output.replace(headMatch[0], newHead);

                // Update output
                document.getElementById('output').value = output;

                // Calculate CSS lines added
                const cssLines = (FONT_FALLBACK + IVEY_CSS).split('\\n').length;
                updateOutputStats(output, cssLines);

                showStatus('‚úÖ CSS successfully inlined! Your widget is now SCORM-ready.', 'success');

            } catch (error) {
                showStatus('Error processing HTML: ' + error.message, 'error');
            }
        }

        function loadSampleWidget() {
            const sample = \`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sample Widget</title>
  <link rel="stylesheet" href="ivey-widget-base.css">
  <style>
    .custom-style {
      background: #f0f0f0;
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="widget-container">
    <div class="widget-header">
      <h1 class="widget-title">Sample Widget</h1>
    </div>
    <div class="widget-content">
      <div class="card">
        <h3 class="card-title">This is a sample widget</h3>
        <p class="card-text">Click "Inline CSS" to convert it for SCORM.</p>
        <button class="btn btn-primary">Sample Button</button>
      </div>
    </div>
  </div>
</body>
</html>\`;

            document.getElementById('input').value = sample;
            updateInputStats();
            showStatus('Sample widget loaded. Click "Inline CSS" to convert.', 'info');
        }

        function copyResult() {
            const output = document.getElementById('output');
            if (!output.value) {
                showStatus('No output to copy. Process a widget first.', 'warning');
                return;
            }

            output.select();
            document.execCommand('copy');
            showStatus('‚úÖ SCORM-ready HTML copied to clipboard!', 'success');
        }

        function downloadResult() {
            const output = document.getElementById('output').value;
            if (!output) {
                showStatus('No output to download. Process a widget first.', 'warning');
                return;
            }

            const blob = new Blob([output], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'widget-scorm-ready.html';
            a.click();
            URL.revokeObjectURL(url);
            showStatus('‚úÖ SCORM-ready HTML file downloaded!', 'success');
        }

        function clearAll() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
            updateInputStats();
            updateOutputStats('', 0);
            document.getElementById('status').textContent = '';
        }

        // Initialize
        updateInputStats();
    </script>
</body>
</html>